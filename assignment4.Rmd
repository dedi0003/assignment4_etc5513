---
title: "Zomato - Best of Melbourne Analysis"
author:
- familyname: Editya
  othernames: Dea Avega
  address: Monash University
  email: XXX
  correspondingauthor: true
  qualifications: Master of BA 
- familyname: Qasim
  othernames: Muhammad Soban
  address: Monash University
  qualifications: Master of BA
- familyname: Sinha 
  othernames: Abhishek
  address: Monash University
  email: XXX
  correspondingauthor: true
  qualifications:  Master of BA
- familyname: Vu 
  othernames: Vinny
  address: Monash University
  email: vvuu0009@student.monash.edu
  correspondingauthor: true
  qualifications:  Master of BA
department: Our consultancy \newline add names &\newline add names
organization: ETC5513 Collaborative and Reproductible Practices 
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: true
    
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      cache=FALSE, 
                      messages=FALSE, 
                      warning=FALSE)

library(romato)
library(dplyr)
library(tidyverse)
library(ggplot2)
library(leaflet)
library(rgdal)
library(readr)
library(mapview)
library(viridis)
library(kableExtra)
library(ggmap)

```

```{r wrangling}
# assign API key
zmt <- zomato$new("1623b413d3a1614e765de7578f83a10b") 

# pull data for category "Best of Melbourne" using Melbourne ID "259"
melb <- zmt$search(entity_id = "259", entity_type = "city", category = "Best of Melbourne")

melb_top100 <- melb %>% 
  select(-offers, -establishment_types, -all_reviews.reviews, -highlights) %>% 
  mutate(aggregate_rating = as.numeric(aggregate_rating), price_range = as.numeric(price_range), longitude = as.numeric(longitude), latitude = as.numeric(latitude))

```

\section*{Introduction} 

In this report we have used the following packages @tidyverse, @romato, @kableExtra, @knitr, @leaflet. 

\section*{Finding The Very Best Restaurants of Melbourne}
The last section of this report is covering composition and distribution of the very best restaurants in Melbourne-Victoria. In order to find the very best restaurant, this report will filter out 100 restaurants which are listed in **"Best of Melbourne"** category on Zomato's website. The very best restaurants are described as one which has rating equals to or more than 4.8 out of 5.
After filtered out the dataset, several highest-rated restaurants fill the top list as shown in table \@ref(tab:best-restaurant).

```{r include=FALSE}

melb_best <- melb_top100 %>% 
  filter(aggregate_rating >= 4.8) %>% 
      as.data.frame()

summary(melb_best)
```


```{r best-restaurant, echo=FALSE}
melb_best_resto <- melb_best %>% 
  select(name, cuisines, locality, price_for_two = average_cost_for_two, rating = aggregate_rating) %>% 
  filter(rating >= 4.8) %>% 
  arrange(desc(rating)) %>% 
  kable(caption = "The Very Best Restaurants in Melbourne According to Zomato Rating") %>% 
  kableExtra::kable_styling(latex_options = c("striped", "hold_position"), stripe_color  = "pink", font_size = 8)

melb_best_resto
```


From table \@ref(tab:best-restaurant) above, there are twelve restaurants which have minimum rating 4.8 out of 5 hence can be described as the very best restaurants in Melbourne. The prices, cuisines and locations in the top list are vary but with some patterns that will be further explored in the following paragraphs.

```{r create-map, include=FALSE}

pal <- colorFactor(palette = "viridis", melb_best$average_cost_for_two)

map_melb <- leaflet(melb_best) %>%
  addTiles() %>% 
  addProviderTiles(providers$CartoDB, options = providerTileOptions(opacity = 1)) %>% 
  addCircleMarkers(lng = melb_best$longitude, 
                   lat = melb_best$latitude, 
                   label = melb_best$name,
  labelOptions = labelOptions(textOnly = T, noHide = T, textsize = "14px"),
  radius = ~ifelse(melb_best$aggregate_rating > 4.8, 10, 6),
  color = ~pal(melb_best$average_cost_for_two),
  stroke = FALSE, fillOpacity = 0.9
  ) %>% 
  addLegend("topright", pal = pal, values = ~average_cost_for_two,
    title = "Average Cost for Two",
    labFormat = labelFormat(prefix = "$"),
    opacity = 1) %>% 
  setView(lng = 145.054570, lat = -37.846302, zoom = 12.44) %>% 
  addRectangles(
    lng1= 144.915218, lat1= -37.86,
    lng2= 145.067654, lat2= -37.786092,
    fillColor = "transparent"
  )

map_melb

mapshot(map_melb, file = paste0(getwd(), "/map.png"))

```

```{r maps, fig.cap="Best of Melbourne", out.width= "70%", fig.align='center', echo = FALSE}
knitr::include_graphics("map.png")
```

Regarding the average price and location of the restaurants, figure \@ref(fig:maps) shows the map plot of these highest-rated restaurants with their attribute of average food price for two person. The average price for two persons is differentiated by color, while larger circle indicates higher rating (4.9).

It is seen from the figure \@ref(fig:maps) that three restaurants are located in CBD, which is not surprising given the nature of CBD as the epicentre of Melbourne. Other restaurants are relatively still located close to CBD like Fitzroy, North Melbourne, Carlton and Hawthorn where eight restaurants base in. One outlier from the list is Shira Nui restaurant, where its location is quite far away from other restaurants in the group. This japanese-sushi restaurant is located in Glen Waverley suburb which is about one and half hour driving from the CBD.


```{r include=FALSE}
#creating dataset for map
melb_icon <- melb_best %>% 
  select(name, locality, cuisines, longitude, latitude, rating = aggregate_rating) %>% 
  as.data.frame()

melb_icon %>% 
  mutate(food_type = str_extract(cuisines, c("Korean", "Sushi", "Coffee", "Coffee", "Australian","Australian", "Sushi", "Sushi", "French","French", "Coffee", "Sushi"))) %>% 
  filter(rating >= 4.8) %>% 
  group_by(locality)

```


```{r include=FALSE}
sushicon <- icons(
  iconUrl = "https://i.imgur.com/7KibpoF.png",
  iconWidth = 25, iconHeight = 30,
  iconAnchorX = 22, iconAnchorY = 40,
  )

auscon <- icons(
  iconUrl = "https://i.imgur.com/CarRew0.png",
  iconWidth = 25, iconHeight = 30,
  iconAnchorX = 22, iconAnchorY = 40,
  )

bbqcon <- icons(
  iconUrl = "https://i.imgur.com/bkvbKSQ.png",
  iconWidth = 25, iconHeight = 30,
  iconAnchorX = 22, iconAnchorY = 40,
  )

frencon <- icons(
  iconUrl = "https://i.imgur.com/P7yAbFI.png",
  iconWidth = 25, iconHeight = 30,
  iconAnchorX = 22, iconAnchorY = 40,
  )

cofcon <- icons(
  iconUrl = "https://i.imgur.com/xFmLqpO.png",
  iconWidth = 25, iconHeight = 30,
  iconAnchorX = 22, iconAnchorY = 70,
  )


map_testcon <- leaflet(melb_icon) %>%
  addTiles() %>% 
  addProviderTiles(providers$CartoDB, options = providerTileOptions(opacity = 1)) %>% 
addMarkers(
  melb_icon$longitude[1], melb_icon$latitude[1],
  icon = bbqcon) %>%
addMarkers(melb_icon$longitude[2], melb_icon$latitude[2],
  icon = sushicon,
  label = ~melb_icon$name[2],
  labelOptions = labelOptions(noHide = T, textOnly = TRUE, textsize = "17px")) %>%
addMarkers(
  melb_icon$longitude[3], melb_icon$latitude[3],
  icon = cofcon,
  label = ~melb_icon$name[3],
  labelOptions = labelOptions(noHide = F, textOnly = TRUE))%>% 
addMarkers(
  melb_icon$longitude[4], melb_icon$latitude[4],
  icon = cofcon,
  label = ~melb_icon$name[4],
  labelOptions = labelOptions(noHide = F, textOnly = TRUE))%>% 
addMarkers(
  melb_icon$longitude[5], melb_icon$latitude[5],
  icon = auscon,
  label = ~melb_icon$name[5],
  labelOptions = labelOptions(noHide = F, textOnly = TRUE))%>% 
  addMarkers(
  melb_icon$longitude[6], melb_icon$latitude[6],
  icon = auscon,
  label = ~melb_icon$name[6],
  labelOptions = labelOptions(noHide = F, textOnly = TRUE, textsize = "17px"))%>% 
addMarkers(
  melb_icon$longitude[7], melb_icon$latitude[7],
  icon = sushicon,
  label = ~melb_icon$name[7],
  labelOptions = labelOptions(noHide = T, textOnly = TRUE, textsize = "17px"))%>% 
addMarkers(
  melb_icon$longitude[8], melb_icon$latitude[8],
  icon = sushicon,
  label = ~melb_icon$name[8],
  labelOptions = labelOptions(noHide = T, textOnly = TRUE, textsize = "17px"))%>% 
addMarkers(
  melb_icon$longitude[9], melb_icon$latitude[9],
  icon = frencon,
  label = ~melb_icon$name[9],
  labelOptions = labelOptions(noHide = F, textOnly = TRUE))%>% 
addMarkers(
  melb_icon$longitude[10], melb_icon$latitude[10],
  icon = frencon,
  label = ~melb_icon$name[10],
  labelOptions = labelOptions(noHide = F, textOnly = TRUE))%>% 
addMarkers(
  melb_icon$longitude[11], melb_icon$latitude[11],
  icon = cofcon,
  label = ~melb_icon$name[11],
  labelOptions = labelOptions(noHide = F, textOnly = TRUE, textsize = "17px")) %>% 
addMarkers(
  melb_icon$longitude[12], melb_icon$latitude[12],
  icon = sushicon,
  label = ~melb_icon$name[12],
  labelOptions = labelOptions(noHide = T, textOnly = TRUE, textsize = "17px"))

map_testcon

mapshot(map_testcon, file = paste0(getwd(), "/map_testcon.png"))

```

Furthermore, four out of twelve highest-rated restaurants in Melbourne are Japanese-Sushi Restaurants, three are coffee shops, while the rest are french and australian food restaurants as indicated by figure \@ref(fig:map-icon). Japanese-sushi restaurant is indicated by sushi icon, Korean-BBQ restaurant is inidicated by meat icon, Coffee shop is depicted by coffee icon, Australian restaurant is indicated by burger icon while French restaurant is flagged by cheese icon.

```{r map-icon, fig.cap="Sushi Restaurants are Dominating Top List", out.width= "70%", fig.align='center', echo = FALSE}
knitr::include_graphics("map_testcon.png")
```

