---
title: "Zomato - Best of Melbourne Analysis"
author:
- familyname: Editya
  othernames: Dea Avega
  address: Monash University
  email: XXX
  correspondingauthor: true
  qualifications: Master of BA 
- familyname: Qasim
  othernames: Muhammad Soban
  address: Monash University
  qualifications: Master of BA
- familyname: Sinha 
  othernames: Abhishek
  address: Monash University
  email: XXX
  correspondingauthor: true
  qualifications:  Master of BA
- familyname: Vu 
  othernames: Vinny
  address: Monash University
  email: vvuu0009@student.monash.edu
  correspondingauthor: true
  qualifications:  Master of BA
department: Our consultancy \newline add names &\newline add names
organization: ETC5513 Collaborative and Reproductible Practices 
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      cache=FALSE, 
                      messages=FALSE, 
                      warning=FALSE)

library(romato)
library(dplyr)
library(tidyverse)
library(ggplot2)
library(leaflet)
library(rgdal)
library(readr)
library(mapview)
library(viridis)
library(kableExtra)

```

```{r wrangling}
# assign API key
zmt <- zomato$new("1623b413d3a1614e765de7578f83a10b") 

# pull data for category "Best of Melbourne" using Melbourne ID "259"
melb <- zmt$search(entity_id = "259", entity_type = "city", category = "Best of Melbourne")

melb_top100 <- melb %>% 
  select(-offers, -establishment_types, -all_reviews.reviews, -highlights) %>% 
  mutate(aggregate_rating = as.numeric(aggregate_rating), price_range = as.numeric(price_range), longitude = as.numeric(longitude), latitude = as.numeric(latitude))

```

\section*{Introduction} 

In this report we have used the following packages @tidyverse, @romato, @kableExtra, @knitr, @leaflet, @rgdal. 

\section*{Map Plot of The Best Restaurants}
This report will look at the distribution of best restaurants (having rating equals to or more than 4.8 out of 5) in Melbourne using leaflet map.

```{r include=FALSE}


# melb_top100 %>% 
#   select(name, aggregate_rating, rating_text, address) %>% 
#   group_by() %>% 
#   arrange(desc(aggregate_rating)) %>% 
#   head(20)

melb_best <- melb_top100 %>% 
  filter(aggregate_rating >= 4.8) %>% 
      as.data.frame()
```


```{r best-restaurant, echo=FALSE}
melb_11 <- melb_best %>% 
  select(name, locality, price_for_two = average_cost_for_two, cuisines, rating = aggregate_rating) %>% 
  filter(rating >= 4.8) %>% 
  group_by(locality) %>% 
  kable(caption = "Top Ten Best Restaurant in Melbourne") %>% 
  kableExtra::kable_styling(latex_options = c("striped", "hold_position"), font_size = 8)

melb_11
```

As shown in table \@ref(tab:best-restaurant) above, there are ten restaurants which rated very high hence can be described as best of the best restaurants in Melbourne.

```{r create-map, include=FALSE}

pal <- colorFactor(palette = "viridis", melb_best$average_cost_for_two)

map_melb <- leaflet(melb_best) %>%
  addTiles() %>% 
  addProviderTiles(providers$CartoDB, options = providerTileOptions(opacity = 1)) %>% 
  addCircleMarkers(lng = melb_best$longitude, 
                   lat = melb_best$latitude, 
                   label = melb_best$name,
  labelOptions = labelOptions(textOnly = T, noHide = T, textsize = "14px"),
  radius = ~ifelse(melb_best$rating_obj.title.text >= 4.8, 10, 15),
  color = ~pal(melb_best$average_cost_for_two),
  stroke = FALSE, fillOpacity = 0.9
  ) %>% 
  addLegend("topright", pal = pal, values = ~average_cost_for_two,
    title = "Average Cost for Two",
    labFormat = labelFormat(prefix = "$"),
    opacity = 1) %>% 
  setView(lng = 145.054570, lat = -37.846302, zoom = 12.44)

map_melb

mapshot(map_melb, file = paste0(getwd(), "/map.png"))

```

```{r maps, fig.cap="Best of Melbourne", out.width= "100%", fig.align='center', echo = FALSE}
knitr::include_graphics("map.png")
```

CBD, Fitzroy and North Melbourne each have two restaurans located in their areas. Other restaurants are located in Carlton, Camberwell, Hawtorn, Richmond and Glen Waverley.
Figure \@ref(fig:maps) above shows the location of these highest-rate restaurants and their average food price. The average price for two persons is differentiated by color.


